const bittrex = require('node-bittrex-api');
const readSecrets = require('./readSecrets')
bittrex.options(readSecrets)

bittrex.options({
  verbose: true,
  websockets: {
    onConnect: function() {
      console.log('onConnect fired');
      bittrex.websockets.listen(function(data, client) {
        if (data.M === 'updateSummaryState') {
          data.A.forEach(function(data_for) {
            data_for.Deltas.forEach(function(marketsDelta) {
              console.log('Ticker Update for '+ marketsDelta.MarketName, marketsDelta);
            });
          });
        }
      });
    },
  },
});

console.log('Connecting ....');
bittrex.websockets.client(function(client) {
  console.log('Connected');
});
